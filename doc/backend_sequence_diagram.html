<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ISPL Backend í˜¸ì¶œ êµ¬ì¡° ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 40px;
            font-size: 1.2em;
        }
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            flex-wrap: wrap;
        }
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background: transparent;
            color: #666;
            font-size: 1.1em;
            font-weight: 600;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        .tab:hover {
            color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }
        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }
        .diagram-container {
            display: none;
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .diagram-container.active {
            display: block;
        }
        .diagram-title {
            color: #2c3e50;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
        }
        .diagram-description {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }
        .diagram-description h4 {
            margin-top: 0;
            color: #667eea;
        }
        .diagram-description ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        .diagram-description li {
            margin: 8px 0;
            color: #555;
        }
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .info-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .info-card h3 {
            margin-top: 0;
            font-size: 1.5em;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            padding-bottom: 10px;
        }
        .info-card ul {
            list-style: none;
            padding: 0;
        }
        .info-card li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
        }
        .info-card li:before {
            content: "âœ“";
            position: absolute;
            left: 0;
            font-weight: bold;
            color: #fff;
        }
        .timestamp {
            text-align: center;
            color: #95a5a6;
            margin-top: 30px;
            font-size: 0.9em;
        }
        .highlight {
            background: #fff3cd;
            padding: 2px 6px;
            border-radius: 3px;
            color: #856404;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”„ ISPL Backend í˜¸ì¶œ êµ¬ì¡°</h1>
        <p class="subtitle">FastAPI â†’ LangGraph â†’ Services â†’ Database ê³„ì¸µë³„ ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨</p>
        
        <div class="tabs">
            <button class="tab active" onclick="showDiagram('search')">ğŸ” ê²€ìƒ‰ í”Œë¡œìš°</button>
            <button class="tab" onclick="showDiagram('upload')">ğŸ“„ ì—…ë¡œë“œ í”Œë¡œìš°</button>
            <button class="tab" onclick="showDiagram('management')">ğŸ“‹ ê´€ë¦¬ í”Œë¡œìš°</button>
        </div>

        <!-- ê²€ìƒ‰ í”Œë¡œìš° -->
        <div id="search-diagram" class="diagram-container active">
            <h2 class="diagram-title">ğŸ” AI ì±„íŒ… ê²€ìƒ‰ í”Œë¡œìš° (7 Agents)</h2>
            
            <div class="diagram-description">
                <h4>ì£¼ìš” í˜¸ì¶œ íë¦„</h4>
                <ul>
                    <li><strong>API Layer:</strong> FastAPIê°€ ì±„íŒ… ìš”ì²­ì„ ë°›ì•„ LangGraph ì‹¤í–‰</li>
                    <li><strong>Agent Layer:</strong> Router â†’ Search â†’ Context Judgement â†’ (Expansion) â†’ Answer</li>
                    <li><strong>Service Layer:</strong> Query ì „ì²˜ë¦¬, Hybrid ê²€ìƒ‰ (Vector + Keyword), RRF ìœµí•©, 4ë‹¨ê³„ ê²€ì¦</li>
                    <li><strong>Database Layer:</strong> PostgreSQL + pgvectorë¡œ ìœ ì‚¬ë„ ê²€ìƒ‰</li>
                    <li><strong>ì™¸ë¶€ API:</strong> OpenAI GPT-4o (Embedding, ë‹µë³€ ìƒì„±)</li>
                </ul>
            </div>

            <div class="mermaid">
sequenceDiagram
    participant Client as ğŸ–¥ï¸ Client
    participant API as FastAPI<br/>chat.py
    participant Graph as LangGraph<br/>graph.py
    participant Router as Router<br/>Agent
    participant Search as Search<br/>Agent
    participant Context as Context<br/>Judgement
    participant Expand as Chunk<br/>Expansion
    participant Answer as Answer<br/>Agent
    participant QPre as Query<br/>Preprocessor
    participant HSearch as Hybrid<br/>Search
    participant VSearch as Vector<br/>Search
    participant Validator as Answer<br/>Validator
    participant DB as ğŸ—„ï¸ PostgreSQL<br/>pgvector
    participant OpenAI as ğŸ¤– OpenAI<br/>GPT-4o

    Client->>+API: POST /api/chat<br/>{query, thread_id}
    API->>API: ë¡œê¹… & ê²€ì¦
    API->>+Graph: run_graph(query, thread_id)
    Graph->>Graph: create_graph()<br/>StateGraph ìƒì„±
    Graph->>Graph: ì´ˆê¸° State ì„¤ì •
    
    Note over Graph,Router: 1ï¸âƒ£ Router Agent
    Graph->>+Router: router_node(state)
    Router->>OpenAI: GPT-4o ì˜ë„ ë¶„ì„
    OpenAI-->>Router: task_type="search"
    Router-->>-Graph: {task_type, next_agent}
    
    Note over Graph,Search: 2ï¸âƒ£ Search Agent
    Graph->>+Search: search_node(state)
    Search->>+QPre: preprocess(query)
    QPre->>QPre: ì •ê·œí™”/í‘œì¤€í™”
    QPre->>QPre: ë™ì˜ì–´ í™•ì¥
    QPre->>QPre: ì¡°í•­ ë²ˆí˜¸ ì¶”ì¶œ
    QPre-->>-Search: PreprocessedQuery
    
    Search->>+HSearch: hybrid_search(query)
    
    par ë³‘ë ¬ ê²€ìƒ‰
        HSearch->>+VSearch: vector_search(query)
        VSearch->>OpenAI: text-embedding-3-large
        OpenAI-->>VSearch: embedding vector
        VSearch->>DB: SELECT<br/>cosine_similarity
        DB-->>VSearch: ë²¡í„° ê²€ìƒ‰ ê²°ê³¼
        VSearch-->>-HSearch: vector_results
    and
        HSearch->>DB: SELECT<br/>to_tsquery(FTS)
        DB-->>HSearch: í‚¤ì›Œë“œ ê²€ìƒ‰ ê²°ê³¼
    end
    
    HSearch->>HSearch: RRF ìœµí•© (K=60)
    HSearch->>HSearch: ì»¨í…ìŠ¤íŠ¸ ìµœì í™”<br/>(20K í† í°)
    HSearch-->>-Search: í†µí•© ê²€ìƒ‰ ê²°ê³¼
    Search-->>-Graph: {search_results}
    
    Note over Graph,Context: 3ï¸âƒ£ Context Judgement Agent
    Graph->>+Context: context_judgement_node(state)
    Context->>Context: ì¶©ë¶„ì„± íŒë‹¨<br/>(ê°œìˆ˜/ìœ ì‚¬ë„/í† í°)
    
    alt ì»¨í…ìŠ¤íŠ¸ ë¶ˆì¶©ë¶„
        Context-->>Graph: {context_sufficient=False}
        Note over Graph,Expand: 4ï¸âƒ£ Chunk Expansion Agent
        Graph->>+Expand: chunk_expansion_node(state)
        Expand->>DB: SELECT<br/>ì¸ì ‘ ì²­í¬ í™•ì¥
        DB-->>Expand: í™•ì¥ëœ ì²­í¬
        Expand-->>-Graph: {expanded_chunks}
        Graph->>Context: ì¬íŒë‹¨ (ìµœëŒ€ 3íšŒ)
    end
    
    Context-->>-Graph: {context_sufficient=True}
    
    Note over Graph,Answer: 5ï¸âƒ£ Answer Agent
    Graph->>+Answer: answer_node(state)
    Answer->>Answer: build_context()
    Answer->>Answer: build_system_prompt()
    Answer->>OpenAI: GPT-4o ë‹µë³€ ìƒì„±<br/>(temp=0.1)
    OpenAI-->>Answer: ì´ˆì•ˆ ë‹µë³€
    
    Answer->>+Validator: validate_answer()
    Validator->>Validator: 1ë‹¨ê³„: í˜•ì‹ ê²€ì¦
    Validator->>Validator: 2ë‹¨ê³„: ì¡°í•­ ê²€ì¦
    Validator->>Validator: 3ë‹¨ê³„: ì»¨í…ìŠ¤íŠ¸ ë§¤ì¹­
    Validator->>Validator: 4ë‹¨ê³„: Hallucination ê²€ì¦
    Validator->>Validator: ì‹ ë¢°ë„ ê³„ì‚°
    
    alt ì‹ ë¢°ë„ < 0.7
        Validator-->>Answer: ê²€ì¦ ì‹¤íŒ¨
        Answer->>OpenAI: ì¬ìƒì„± ìš”ì²­<br/>(ìµœëŒ€ 3íšŒ)
        OpenAI-->>Answer: ê°œì„ ëœ ë‹µë³€
        Answer->>Validator: ì¬ê²€ì¦
    end
    
    Validator-->>-Answer: {valid=True, score}
    Answer-->>-Graph: {final_answer, metadata}
    
    Graph-->>-API: final_state
    API->>API: ChatResponse ìƒì„±
    API-->>-Client: 200 OK<br/>{answer, search_results}
            </div>
        </div>

        <!-- ì—…ë¡œë“œ í”Œë¡œìš° -->
        <div id="upload-diagram" class="diagram-container">
            <h2 class="diagram-title">ğŸ“„ ë¬¸ì„œ ì—…ë¡œë“œ í”Œë¡œìš°</h2>
            
            <div class="diagram-description">
                <h4>ì£¼ìš” í˜¸ì¶œ íë¦„</h4>
                <ul>
                    <li><strong>API Layer:</strong> FastAPIê°€ PDF íŒŒì¼ ì—…ë¡œë“œ ë°›ì•„ ì²˜ë¦¬</li>
                    <li><strong>Agent Layer:</strong> Router â†’ Processing Agent</li>
                    <li><strong>Service Layer:</strong> í•˜ì´ë¸Œë¦¬ë“œ PDF ì „ì²˜ë¦¬ (PyMuPDF + GPT-4o Vision), Quality ê²€ì¦, Chunking, Embedding</li>
                    <li><strong>Database Layer:</strong> ë¬¸ì„œ/ì²­í¬ ì €ì¥, ë²¡í„° ì¸ë±ì‹±</li>
                </ul>
            </div>

            <div class="mermaid">
sequenceDiagram
    participant Client as ğŸ–¥ï¸ Client
    participant API as FastAPI<br/>pdf.py
    participant Graph as LangGraph<br/>graph.py
    participant Router as Router<br/>Agent
    participant Process as Processing<br/>Agent
    participant PDFProc as PDF<br/>Processor
    participant PyMu as PyMuPDF<br/>Extractor
    participant Vision as Vision<br/>Extractor
    participant Merger as Hybrid<br/>Merger
    participant QValid as Quality<br/>Validator
    participant Chunker as Chunker<br/>Service
    participant EmbSvc as Embedding<br/>Service
    participant DB as ğŸ—„ï¸ PostgreSQL<br/>pgvector
    participant OpenAI as ğŸ¤– OpenAI<br/>GPT-4o

    Client->>+API: POST /api/upload<br/>{file, method="both"}
    API->>API: íŒŒì¼ ê²€ì¦<br/>(PDF, 50MB ì œí•œ)
    API->>API: temp ì €ì¥
    API->>+Graph: run_graph(task_type="upload")
    
    Note over Graph,Router: 1ï¸âƒ£ Router Agent
    Graph->>+Router: router_node(state)
    Router->>Router: task_type í™•ì¸
    Router-->>-Graph: {next_agent="processing_agent"}
    
    Note over Graph,Process: 2ï¸âƒ£ Processing Agent
    Graph->>+Process: processing_node(state)
    Process->>Process: ë©”íƒ€ë°ì´í„° ì¶”ì¶œ
    
    Process->>+PDFProc: process_pdf(file, method)
    
    alt method="pymupdf"
        PDFProc->>+PyMu: extract_text(pdf_path)
        PyMu->>PyMu: PyMuPDF4LLM<br/>í…ìŠ¤íŠ¸ ì¶”ì¶œ
        PyMu-->>-PDFProc: í…ìŠ¤íŠ¸ + ë©”íƒ€
    
    else method="vision"
        PDFProc->>+Vision: extract_with_vision(pdf_path)
        Vision->>Vision: PDF â†’ ì´ë¯¸ì§€ ë³€í™˜
        Vision->>OpenAI: GPT-4o Vision API<br/>(ì´ë¯¸ì§€ â†’ í…ìŠ¤íŠ¸)
        OpenAI-->>Vision: ì¶”ì¶œ í…ìŠ¤íŠ¸
        Vision-->>-PDFProc: í…ìŠ¤íŠ¸ + ë©”íƒ€
    
    else method="both" (â­ í•˜ì´ë¸Œë¦¬ë“œ)
        par ë³‘ë ¬ ì¶”ì¶œ
            PDFProc->>+PyMu: extract_text(pdf_path)
            PyMu-->>-PDFProc: pymupdf_result
        and
            PDFProc->>+Vision: extract_with_vision(pdf_path, context)
            Vision->>OpenAI: GPT-4o Vision<br/>(ì´ë¯¸ì§€ + PyMuPDF ì»¨í…ìŠ¤íŠ¸)
            OpenAI-->>Vision: vision_result
            Vision-->>-PDFProc: vision_result
        end
        
        PDFProc->>+Merger: merge_results(pymupdf, vision)
        Merger->>Merger: í˜ì´ì§€ë³„ ë§¤ì¹­
        Merger->>Merger: í’ˆì§ˆ ì ìˆ˜ ê³„ì‚°
        Merger->>Merger: ë“€ì–¼ í˜ì´ì§€ ë²ˆí˜¸<br/>(PDF/Vision)
        Merger-->>-PDFProc: í†µí•© ê²°ê³¼
    end
    
    PDFProc->>+QValid: validate_quality(result)
    QValid->>QValid: ì™„ì„±ë„ ê²€ì‚¬
    QValid->>QValid: êµ¬ì¡° ë¶„ì„
    QValid->>QValid: í’ˆì§ˆ ì ìˆ˜ ê³„ì‚°
    QValid-->>-PDFProc: validation_report
    
    alt í’ˆì§ˆ ë¯¸ë‹¬
        PDFProc-->>Process: {error: "í’ˆì§ˆ ë¯¸ë‹¬"}
        Process-->>Graph: {success=False}
        Graph-->>API: ì‹¤íŒ¨ ì‘ë‹µ
        API-->>Client: 400 Bad Request
    end
    
    PDFProc-->>-Process: ì¶”ì¶œ ì™„ë£Œ
    
    Process->>DB: INSERT documents<br/>(íŠ¸ëœì­ì…˜ ì‹œì‘)
    DB-->>Process: document_id
    
    Process->>+Chunker: chunk_text(text)
    Chunker->>Chunker: í† í° ê¸°ë°˜ ë¶„í• <br/>(1000í† í°, 200 ì˜¤ë²„ë©)
    Chunker->>Chunker: ì¡°í•­ ë²ˆí˜¸ ì¶”ì¶œ
    Chunker-->>-Process: chunks[]
    
    loop ê° ì²­í¬ë§ˆë‹¤
        Process->>+EmbSvc: get_embedding(chunk.content)
        EmbSvc->>EmbSvc: Cache í™•ì¸<br/>(MemoryCache)
        
        alt Cache Miss
            EmbSvc->>OpenAI: text-embedding-3-large
            OpenAI-->>EmbSvc: embedding vector (3072ì°¨ì›)
            EmbSvc->>EmbSvc: Cache ì €ì¥
        end
        
        EmbSvc-->>-Process: embedding_vector
        
        Process->>DB: INSERT chunks<br/>{content, embedding, metadata}
        DB->>DB: HNSW ì¸ë±ì‹±
        DB-->>Process: chunk_id
    end
    
    Process->>DB: COMMIT<br/>íŠ¸ëœì­ì…˜ ì™„ë£Œ
    DB-->>Process: ì„±ê³µ
    
    Process-->>-Graph: {success=True, document_id, chunk_count}
    Graph-->>-API: final_state
    
    API->>API: temp íŒŒì¼ ì‚­ì œ
    API->>API: ì‘ë‹µ ìƒì„±
    API-->>-Client: 200 OK<br/>{document_id, chunks, status}
            </div>
        </div>

        <!-- ê´€ë¦¬ í”Œë¡œìš° -->
        <div id="management-diagram" class="diagram-container">
            <h2 class="diagram-title">ğŸ“‹ ë¬¸ì„œ ê´€ë¦¬ í”Œë¡œìš°</h2>
            
            <div class="diagram-description">
                <h4>ì£¼ìš” í˜¸ì¶œ íë¦„</h4>
                <ul>
                    <li><strong>API Layer:</strong> FastAPIê°€ ë¬¸ì„œ ê´€ë¦¬ ìš”ì²­ ì²˜ë¦¬ (ëª©ë¡ ì¡°íšŒ, ìƒì„¸ ì¡°íšŒ, ì‚­ì œ)</li>
                    <li><strong>Agent Layer:</strong> Router â†’ Management Agent</li>
                    <li><strong>Service Layer:</strong> DocumentManagementServiceë¡œ í•„í„°ë§, ì •ë ¬, í˜ì´ì§€ë„¤ì´ì…˜</li>
                    <li><strong>Database Layer:</strong> PostgreSQLì—ì„œ ë¬¸ì„œ/ì²­í¬ CRUD</li>
                </ul>
            </div>

            <div class="mermaid">
sequenceDiagram
    participant Client as ğŸ–¥ï¸ Client
    participant API as FastAPI<br/>documents.py
    participant Graph as LangGraph<br/>graph.py
    participant Router as Router<br/>Agent
    participant Mgmt as Management<br/>Agent
    participant DocSvc as Document<br/>Management<br/>Service
    participant DB as ğŸ—„ï¸ PostgreSQL

    rect rgb(230, 240, 255)
        Note over Client,DB: ğŸ“‹ ë¬¸ì„œ ëª©ë¡ ì¡°íšŒ
        Client->>+API: GET /api/documents<br/>{filename, sort_by, limit}
        API->>+Graph: run_graph(task_type="manage")
        
        Graph->>+Router: router_node(state)
        Router-->>-Graph: {next_agent="management_agent"}
        
        Graph->>+Mgmt: management_node(state)
        Mgmt->>+DocSvc: list_documents(filters)
        DocSvc->>DB: SELECT documents<br/>WHERE + ORDER BY + LIMIT
        DB-->>DocSvc: documents[]
        DocSvc->>DocSvc: í˜ì´ì§€ë„¤ì´ì…˜ ì²˜ë¦¬
        DocSvc-->>-Mgmt: {documents, total, has_more}
        Mgmt-->>-Graph: {task_results}
        
        Graph-->>-API: final_state
        API-->>-Client: 200 OK<br/>{documents, pagination}
    end

    rect rgb(255, 240, 230)
        Note over Client,DB: ğŸ“„ ë¬¸ì„œ ìƒì„¸ ì¡°íšŒ
        Client->>+API: GET /api/documents/{doc_id}
        API->>+DocSvc: get_document_detail(doc_id)
        DocSvc->>DB: SELECT documents<br/>WHERE id = doc_id
        DB-->>DocSvc: document
        DocSvc->>DB: SELECT COUNT(*)<br/>FROM chunks
        DB-->>DocSvc: chunk_count
        DocSvc-->>-API: {document, chunks, stats}
        API-->>-Client: 200 OK<br/>{document_detail}
    end

    rect rgb(255, 230, 230)
        Note over Client,DB: ğŸ—‘ï¸ ë¬¸ì„œ ì‚­ì œ
        Client->>+API: DELETE /api/documents/{doc_id}
        API->>+Graph: run_graph(task_type="manage")
        
        Graph->>+Router: router_node(state)
        Router-->>-Graph: {next_agent="management_agent"}
        
        Graph->>+Mgmt: management_node(state)
        Mgmt->>+DocSvc: delete_document(doc_id)
        DocSvc->>DB: BEGIN TRANSACTION
        DocSvc->>DB: DELETE FROM chunks<br/>WHERE document_id = doc_id<br/>(CASCADE)
        DB-->>DocSvc: ì‚­ì œëœ ì²­í¬ ìˆ˜
        DocSvc->>DB: DELETE FROM documents<br/>WHERE id = doc_id
        DB-->>DocSvc: 1 row deleted
        DocSvc->>DB: COMMIT
        DocSvc-->>-Mgmt: {success=True, deleted_chunks}
        Mgmt-->>-Graph: {task_results}
        
        Graph-->>-API: final_state
        API-->>-Client: 200 OK<br/>{message: "ì‚­ì œ ì™„ë£Œ"}
    end
            </div>
        </div>

        <!-- ì•„í‚¤í…ì²˜ ì •ë³´ -->
        <div class="info-grid">
            <div class="info-card">
                <h3>ğŸ—ï¸ ê³„ì¸µ êµ¬ì¡°</h3>
                <ul>
                    <li>API Layer (FastAPI Routes)</li>
                    <li>Agent Layer (LangGraph 7 Agents)</li>
                    <li>Service Layer (18 Services)</li>
                    <li>Repository Layer (ORM)</li>
                    <li>Database Layer (PostgreSQL + pgvector)</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3>ğŸ”„ ë™ê¸°/ë¹„ë™ê¸° ì²˜ë¦¬</h3>
                <ul>
                    <li>FastAPI: async def ê¸°ë°˜</li>
                    <li>LangGraph: ainvoke, astream</li>
                    <li>SQLAlchemy: AsyncSession</li>
                    <li>OpenAI: AsyncOpenAI</li>
                    <li>ë³‘ë ¬ ì²˜ë¦¬: asyncio.gather</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3>ğŸ¯ í•µì‹¬ ì„œë¹„ìŠ¤</h3>
                <ul>
                    <li>QueryPreprocessor: ì§ˆì˜ ì „ì²˜ë¦¬</li>
                    <li>HybridSearchService: RRF ìœµí•©</li>
                    <li>AnswerValidator: 4ë‹¨ê³„ ê²€ì¦</li>
                    <li>PDFProcessor: í•˜ì´ë¸Œë¦¬ë“œ ì „ì²˜ë¦¬</li>
                    <li>EmbeddingService: ìºì‹± ì§€ì›</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3>ğŸ’¾ ë°ì´í„° íë¦„</h3>
                <ul>
                    <li>State: TypedDict ê¸°ë°˜</li>
                    <li>Pydantic: ê²€ì¦ ëª¨ë¸</li>
                    <li>SQLAlchemy: ORM ëª¨ë¸</li>
                    <li>JSON: API ì‘ë‹µ</li>
                    <li>Vector: 3072ì°¨ì› ì„ë² ë”©</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3>ğŸ”’ íŠ¸ëœì­ì…˜ ê´€ë¦¬</h3>
                <ul>
                    <li>ì—…ë¡œë“œ: ë¬¸ì„œ+ì²­í¬ ì›ìì„±</li>
                    <li>ì‚­ì œ: CASCADEë¡œ ìë™ ì •ë¦¬</li>
                    <li>ê²€ìƒ‰: READ COMMITTED</li>
                    <li>ì„¸ì…˜: dependency injection</li>
                    <li>Connection Pool: 5-20 connections</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3>âš¡ ì„±ëŠ¥ ìµœì í™”</h3>
                <ul>
                    <li>MemoryCache: LRU 10K ì„ë² ë”©</li>
                    <li>HNSW Index: ë²¡í„° ê²€ìƒ‰ ê°€ì†</li>
                    <li>ë³‘ë ¬ ê²€ìƒ‰: Vector + Keyword</li>
                    <li>ì»¨í…ìŠ¤íŠ¸ ìµœì í™”: 20K í† í°</li>
                    <li>Connection Pool: ì¬ì‚¬ìš©</li>
                </ul>
            </div>
        </div>
        
        <p class="timestamp">ìƒì„± ì‹œê°„: 2025-10-29 | Backend í˜¸ì¶œ êµ¬ì¡° v1.0</p>
    </div>
    
    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            sequence: {
                diagramMarginX: 50,
                diagramMarginY: 10,
                actorMargin: 80,
                width: 180,
                height: 65,
                boxMargin: 10,
                boxTextMargin: 5,
                noteMargin: 10,
                messageMargin: 35,
                mirrorActors: true,
                useMaxWidth: true
            }
        });

        function showDiagram(diagramId) {
            // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ëª¨ë“  ë‹¤ì´ì–´ê·¸ë¨ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.diagram-container').forEach(container => {
                container.classList.remove('active');
            });
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            event.currentTarget.classList.add('active');
            
            // ì„ íƒëœ ë‹¤ì´ì–´ê·¸ë¨ í‘œì‹œ
            const selectedDiagram = document.getElementById(diagramId + '-diagram');
            if (selectedDiagram) {
                selectedDiagram.classList.add('active');
            }
        }
    </script>
</body>
</html>

