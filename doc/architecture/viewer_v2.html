<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ISPL ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ ë·°ì–´ v2</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .version-badge {
            display: inline-block;
            background: #28a745;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-top: 10px;
            font-weight: 600;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .tab {
            background: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .viewer-container {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: auto;
        }
        
        .diagram {
            display: none;
            width: 100%;
            overflow: auto;
        }
        
        .diagram.active {
            display: block;
        }
        
        .diagram svg {
            width: 100%;
            height: auto;
            max-width: 100%;
        }
        
        .description {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .description h3 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .description p {
            color: #555;
            line-height: 1.6;
            margin-bottom: 8px;
        }
        
        .description .new-feature {
            color: #28a745;
            font-weight: 600;
        }
        
        .description ul {
            margin-left: 20px;
            color: #555;
            line-height: 1.8;
        }
        
        footer {
            text-align: center;
            color: white;
            margin-top: 30px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ—ï¸ ISPL ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨</h1>
            <p class="subtitle">Insurance Policy - Agentic AI System</p>
            <span class="version-badge">â­ Version 2.0 - ì‹¤ì œ êµ¬í˜„ ê¸°ë°˜</span>
        </header>
        
        <div class="tabs">
            <button class="tab active" onclick="showDiagram('overview')">
                01. ì‹œìŠ¤í…œ ì „ì²´ êµ¬ì¡°
            </button>
            <button class="tab" onclick="showDiagram('agents')">
                02. 7ê°œ Multi-Agent â­
            </button>
            <button class="tab" onclick="showDiagram('pipeline')">
                03. PDF ì „ì²˜ë¦¬
            </button>
            <button class="tab" onclick="showDiagram('search')">
                04. ê²€ìƒ‰ & ë‹µë³€ â­
            </button>
            <button class="tab" onclick="showDiagram('schema')">
                05. DB ìŠ¤í‚¤ë§ˆ â­
            </button>
            <button class="tab" onclick="showDiagram('tech')">
                06. ê¸°ìˆ  ìŠ¤íƒ â­
            </button>
            <button class="tab" onclick="showDiagram('userflow')">
                07. ì‚¬ìš©ì í”Œë¡œìš° â­
            </button>
            <button class="tab" onclick="showDiagram('localarch')">
                08. ë¡œì»¬ ì•„í‚¤í…ì²˜ â­
            </button>
            <button class="tab" onclick="showDiagram('langgraph')">
                09. LangGraph Flow â­
            </button>
        </div>
        
        <div class="viewer-container">
            <div id="overview" class="diagram active">
                <object data="01_system_overview_v2.svg" type="image/svg+xml" width="100%" height="950"></object>
                <div class="description">
                    <h3>ğŸ“Š ì‹œìŠ¤í…œ ì „ì²´ êµ¬ì¡° v2</h3>
                    <p>
                        ISPL ì‹œìŠ¤í…œì˜ 3ê³„ì¸µ ì•„í‚¤í…ì²˜ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. 
                        Frontend (Next.js 15.0.3 + React 18.3.1), Backend (FastAPI 0.115.0 + LangGraph 0.3.27+), 
                        ê·¸ë¦¬ê³  ì™¸ë¶€ ì„œë¹„ìŠ¤ (OpenAI, PostgreSQL, MemoryCache)ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.
                    </p>
                    <p class="new-feature">â­ v2 ì—…ë°ì´íŠ¸:</p>
                    <ul>
                        <li>7ê°œ ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ ëª…ì‹œ</li>
                        <li>MemoryCache í‘œì‹œ (Redis ëŒ€ì²´)</li>
                        <li>ëŒ€í™” ì´ë ¥ ê¸°ëŠ¥ ì¶”ê°€</li>
                        <li>ì‹¤ì œ ë²„ì „ ë²ˆí˜¸ ë°˜ì˜</li>
                    </ul>
                </div>
            </div>
            
            <div id="agents" class="diagram">
                <object data="02_langgraph_agents_v2.svg" type="image/svg+xml" width="100%" height="1300"></object>
                <div class="description">
                    <h3>ğŸ¤– LangGraph Multi-Agent ìƒì„¸ v2 (7ê°œ ì—ì´ì „íŠ¸)</h3>
                    <p>
                        7ê°œì˜ ì „ë¬¸í™”ëœ Agentì˜ ì›Œí¬í”Œë¡œìš°ì™€ ìƒí˜¸ì‘ìš©ì„ ìƒì„¸íˆ ë³´ì—¬ì¤ë‹ˆë‹¤.
                    </p>
                    <p class="new-feature">â­ v2 ì—…ë°ì´íŠ¸ (5ê°œ â†’ 7ê°œ):</p>
                    <ul>
                        <li><strong>Context Judgement Agent</strong> â­ NEW: ì»¨í…ìŠ¤íŠ¸ ì¶©ë¶„ì„± íŒë‹¨</li>
                        <li><strong>Chunk Expansion Agent</strong> â­ NEW: ë™ì  ì²­í¬ í™•ì¥</li>
                        <li>ì¡°ê±´ë¶€ ë¼ìš°íŒ… ë° ì¬íŒë‹¨ ë£¨í”„</li>
                        <li>Search Agent: í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ ê°•í™” (RRF)</li>
                        <li>Answer Agent: 4ë‹¨ê³„ ê²€ì¦ ì¶”ê°€</li>
                    </ul>
                </div>
            </div>
            
            <div id="pipeline" class="diagram">
                <object data="03_pdf_processing_pipeline_v2.svg" type="image/svg+xml" width="100%" height="1250"></object>
                <div class="description">
                    <h3>âš™ï¸ PDF ì „ì²˜ë¦¬ í•˜ì´ë¸Œë¦¬ë“œ íŒŒì´í”„ë¼ì¸ v2</h3>
                    <p>
                        Path 1 (PyMuPDF4LLM ì§ì ‘ ì¶”ì¶œ)ê³¼ Path 2 (GPT-4o Vision ë©€í‹°ëª¨ë‹¬)ë¥¼ 
                        ë³‘ë ¬ë¡œ ì‹¤í–‰í•˜ê³  ê²°ê³¼ë¥¼ ë³‘í•©í•˜ëŠ” ê³ í’ˆì§ˆ ì „ì²˜ë¦¬ ê³¼ì •ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.
                    </p>
                    <p class="new-feature">â­ v2 ì—…ë°ì´íŠ¸:</p>
                    <ul>
                        <li>GPT-4 Vision â†’ GPT-4o Vision</li>
                        <li>QualityValidator ë‹¨ê³„ ê°•ì¡°</li>
                        <li>EmbeddingCache (MemoryCache) í‘œì‹œ</li>
                        <li>ì²˜ë¦¬ ì‹œê°„ ëª…ì‹œ (PyMuPDF: 5-10ì´ˆ, Vision: 30-60ì´ˆ)</li>
                        <li>ì„œë¹„ìŠ¤ ì»´í¬ë„ŒíŠ¸ ëª©ë¡ ì¶”ê°€</li>
                        <li>pdf_page_number í•„ë“œ í‘œì‹œ</li>
                    </ul>
                </div>
            </div>
            
            <div id="search" class="diagram">
                <object data="04_search_answer_flow_v2.svg" type="image/svg+xml" width="100%" height="1850"></object>
                <div class="description">
                    <h3>ğŸ” ê²€ìƒ‰ ë° ë‹µë³€ ìƒì„± í”Œë¡œìš° v2</h3>
                    <p>
                        ì‚¬ìš©ì ì§ˆì˜ë¶€í„° ìµœì¢… ë‹µë³€ê¹Œì§€ì˜ ì „ì²´ í”„ë¡œì„¸ìŠ¤ë¥¼ ë‹¨ê³„ë³„ë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤. 
                        (ê¸°ì¡´ 8ë‹¨ê³„ â†’ 12ë‹¨ê³„ë¡œ í™•ì¥)
                    </p>
                    <p class="new-feature">â­ v2 ì—…ë°ì´íŠ¸:</p>
                    <ul>
                        <li><strong>Query ì „ì²˜ë¦¬</strong> â­ NEW: QueryPreprocessor (ì •ê·œí™”/í‘œì¤€í™”/í‚¤ì›Œë“œ ì¶”ì¶œ)</li>
                        <li><strong>í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰</strong> â­ ENHANCED: RRF ìœµí•© (K=60), ìµœëŒ€ 20K í† í°</li>
                        <li><strong>ì»¨í…ìŠ¤íŠ¸ íŒë‹¨</strong> â­ NEW: Context Judgement Agent</li>
                        <li><strong>ì²­í¬ í™•ì¥</strong> â­ NEW: Chunk Expansion Agent (ì¬íŒë‹¨ ë£¨í”„)</li>
                        <li><strong>4ë‹¨ê³„ ê²€ì¦</strong> â­ NEW: í˜•ì‹(10%) + ì¡°í•­(20%) + ì»¨í…ìŠ¤íŠ¸(30%) + í• ë£¨ì‹œë„¤ì´ì…˜(40%)</li>
                        <li>GPT-4o ì‚¬ìš© (temperature: 0.1)</li>
                    </ul>
                </div>
            </div>
            
            <div id="schema" class="diagram">
                <object data="05_database_schema_v2.svg" type="image/svg+xml" width="100%" height="950"></object>
                <div class="description">
                    <h3>ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ v2</h3>
                    <p>
                        PostgreSQL 17.6 + pgvector 0.3.6 ë°ì´í„°ë² ì´ìŠ¤ì˜ í…Œì´ë¸” êµ¬ì¡°ì™€ ê´€ê³„ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.
                    </p>
                    <p class="new-feature">â­ v2 ì—…ë°ì´íŠ¸:</p>
                    <ul>
                        <li><strong>document_chunks</strong>: pdf_page_number í•„ë“œ ì¶”ê°€ (ì´ì¤‘ í˜ì´ì§€ ì‹œìŠ¤í…œ)</li>
                        <li><strong>chat_sessions</strong> â­ NEW: ì±„íŒ… ì„¸ì…˜ ê´€ë¦¬ í…Œì´ë¸”</li>
                        <li><strong>chat_messages</strong> â­ NEW: ëŒ€í™” ë©”ì‹œì§€ ì €ì¥ í…Œì´ë¸”</li>
                        <li>ìƒˆë¡œìš´ ê´€ê³„: users â†’ chat_sessions â†’ chat_messages (CASCADE DELETE)</li>
                        <li>ì¸ë±ìŠ¤ ì¶”ê°€: pdf_page_number, session_id</li>
                    </ul>
                </div>
            </div>
            
            <div id="tech" class="diagram">
                <object data="06_tech_stack_v2.svg" type="image/svg+xml" width="100%" height="850"></object>
                <div class="description">
                    <h3>ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ v2 (ì‹¤ì œ ë²„ì „)</h3>
                    <p>
                        í”„ë¡œì íŠ¸ì—ì„œ ì‹¤ì œë¡œ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ê¸°ìˆ ê³¼ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ì •í™•í•œ ë²„ì „ì„ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.
                        (2025-10-27 ê¸°ì¤€)
                    </p>
                    <p class="new-feature">â­ v2 ì—…ë°ì´íŠ¸ (ì‹¤ì œ ë²„ì „ ë°˜ì˜):</p>
                    <ul>
                        <li><strong>AI/ML</strong>: GPT-4o (gpt-4o) â­, GPT-4o Vision â­, OpenAI SDK 1.55.3</li>
                        <li><strong>Frontend</strong>: Next.js 15.0.3, React 18.3.1, TypeScript 5.6.3, react-markdown 9.0.1 â­</li>
                        <li><strong>Backend</strong>: FastAPI 0.115.0, LangGraph 0.3.27+, SQLAlchemy 2.0.35, Pydantic 2.10.2</li>
                        <li><strong>Data</strong>: kiwipiepy 0.21.0 â­, tenacity 9.0.0 â­, OpenCV 4.10.0.84, Pillow 11.0.0</li>
                        <li><strong>Database</strong>: PostgreSQL 17.6, pgvector 0.3.6, asyncpg 0.30.0</li>
                        <li><strong>Cache</strong>: MemoryCache (LRU, 10K í•­ëª©) â­ - Redis ëŒ€ì‹  ì‚¬ìš©</li>
                    </ul>
                </div>
            </div>
            
            <div id="userflow" class="diagram">
                <object data="07_user_flow.svg" type="image/svg+xml" width="100%" height="2000"></object>
                <div class="description">
                    <h3>ğŸ‘¤ ì‚¬ìš©ì í”Œë¡œìš° v2</h3>
                    <p>
                        ì‚¬ìš©ì ê´€ì ì˜ 3ê°€ì§€ ì£¼ìš” ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‹œê°í™”í•œ End-to-End í”Œë¡œìš°ì…ë‹ˆë‹¤.
                    </p>
                    <p class="new-feature">â­ 3ê°€ì§€ ì£¼ìš” í”Œë¡œìš°:</p>
                    <ul>
                        <li><strong>Flow 1: AI ì±„íŒ… ì§ˆì˜</strong> - ì§ˆë¬¸ ì…ë ¥ë¶€í„° ë‹µë³€ í‘œì‹œê¹Œì§€ (7ë‹¨ê³„)</li>
                        <li><strong>Flow 2: ì•½ê´€ ì—…ë¡œë“œ</strong> - íŒŒì¼ ì—…ë¡œë“œë¶€í„° DB ì €ì¥ê¹Œì§€ (8ë‹¨ê³„)</li>
                        <li><strong>Flow 3: ëŒ€í™” ì´ë ¥ ê´€ë¦¬</strong> - ì„¸ì…˜ ì¡°íšŒë¶€í„° ëŒ€í™” ì´ì–´ê°€ê¸°ê¹Œì§€ (7ë‹¨ê³„)</li>
                    </ul>
                    <p class="new-feature">ê³µí†µ ê¸°ëŠ¥:</p>
                    <ul>
                        <li>ë¡œë”© ìƒíƒœ í‘œì‹œ (ìŠ¤í”¼ë„ˆ/í”„ë¡œê·¸ë ˆìŠ¤ë°”)</li>
                        <li>ì—ëŸ¬ í•¸ë“¤ë§ (Toast/Alert)</li>
                        <li>ìë™ ì €ì¥ (ëŒ€í™” ì´ë ¥)</li>
                        <li>Markdown ë Œë”ë§</li>
                    </ul>
                </div>
            </div>
            
            <div id="localarch" class="diagram">
                <object data="08_local_architecture.svg" type="image/svg+xml" width="100%" height="800"></object>
                <div class="description">
                    <h3>ğŸ¢ ë¡œì»¬ í™˜ê²½ ì•„í‚¤í…ì²˜ â­ NEW</h3>
                    <p>
                        í˜„ì¬ ê°œë°œ í™˜ê²½ì˜ ì‹¤ì œ ì•„í‚¤í…ì²˜ë¥¼ AWS ìŠ¤íƒ€ì¼ë¡œ ì‹œê°í™”í–ˆìŠµë‹ˆë‹¤.
                        ì¢Œì¸¡ì—ì„œ ìš°ì¸¡ìœ¼ë¡œ ë°ì´í„° íë¦„ì„ í‘œí˜„í•©ë‹ˆë‹¤.
                    </p>
                    <p class="new-feature">â­ ì£¼ìš” êµ¬ì„± ìš”ì†Œ:</p>
                    <ul>
                        <li><strong>ì‚¬ìš©ì</strong> â†’ <strong>Frontend</strong> (Next.js 15 + React 18)</li>
                        <li><strong>Backend</strong> (FastAPI 0.115 + LangGraph 7ê°œ Agent)</li>
                        <li><strong>OpenAI API</strong> (GPT-4o, Embeddings, Vision)</li>
                        <li><strong>PostgreSQL 17.6</strong> (pgvector, HNSW Index)</li>
                        <li><strong>File System</strong> (ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ - uploads/)</li>
                        <li><strong>MemoryCache</strong> (LRU, 10K í•­ëª©)</li>
                    </ul>
                    <p class="new-feature">íŠ¹ì§•:</p>
                    <ul>
                        <li>3D ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ (AWS ì•„í‚¤í…ì²˜ ì°¸ê³ )</li>
                        <li>ê° ê¸°ìˆ ë³„ ê³µì‹ ë¸Œëœë“œ ìƒ‰ìƒ ì‚¬ìš©</li>
                        <li>ë‹¨ë°©í–¥ í™”ì‚´í‘œë¡œ ë°ì´í„° íë¦„ í‘œì‹œ</li>
                    </ul>
                </div>
            </div>
            
            <div id="langgraph" class="diagram">
                <object data="09_langgraph_flow.svg" type="image/svg+xml" width="100%" height="1800"></object>
                <div class="description">
                    <h3>ğŸ”„ LangGraph Multi-Agent Workflow â­ NEW</h3>
                    <p>
                        LangGraph ê¸°ë°˜ 7ê°œ Agentì˜ ì‹¤ì œ ì‹¤í–‰ íë¦„ì„ í”Œë¡œìš°ì°¨íŠ¸ë¡œ í‘œí˜„í–ˆìŠµë‹ˆë‹¤.
                        ì¡°ê±´ë¶€ ë¼ìš°íŒ… ë° ì¬íŒë‹¨ ë£¨í”„ë¥¼ ëª…í™•í•˜ê²Œ ë³´ì—¬ì¤ë‹ˆë‹¤.
                    </p>
                    <p class="new-feature">â­ Agent íë¦„:</p>
                    <ul>
                        <li><strong>start</strong> â†’ Router Agent (ì˜ë„ ë¶„ì„)</li>
                        <li><strong>ì¡°ê±´ë¶€ ë¼ìš°íŒ…</strong>: search/upload/manage</li>
                        <li><strong>Search ê²½ë¡œ</strong>:
                            <ul>
                                <li>Search Agent â†’ Context Judgement Agent</li>
                                <li>ì¶©ë¶„ â†’ Answer Agent â†’ 4ë‹¨ê³„ ê²€ì¦</li>
                                <li>ë¶ˆì¶©ë¶„ â†’ Chunk Expansion Agent â†’ ì¬íŒë‹¨ (ìµœëŒ€ 3íšŒ)</li>
                            </ul>
                        </li>
                        <li><strong>Upload ê²½ë¡œ</strong>: Processing Agent (í•˜ì´ë¸Œë¦¬ë“œ ì „ì²˜ë¦¬)</li>
                        <li><strong>Manage ê²½ë¡œ</strong>: Management Agent (ë¬¸ì„œ CRUD)</li>
                    </ul>
                    <p class="new-feature">íŠ¹ì§•:</p>
                    <ul>
                        <li>ê¹”ë”í•œ í”Œë¡œìš°ì°¨íŠ¸ ìŠ¤íƒ€ì¼</li>
                        <li>ì‹¤ì„ /ì ì„ /ì¡°ê±´ë¶€ í™”ì‚´í‘œ êµ¬ë¶„</li>
                        <li>í•˜ë‹¨ì— ê° Agent ìƒì„¸ ì„¤ëª… í¬í•¨</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Â© 2025 ISPL Project - Architecture Documentation v2.0</p>
            <p style="font-size: 0.9em; margin-top: 5px;">ì‹¤ì œ êµ¬í˜„ ê¸°ë°˜ (2025-10-27)</p>
        </footer>
    </div>
    
    <script>
        function showDiagram(id) {
            // ëª¨ë“  ë‹¤ì´ì–´ê·¸ë¨ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.diagram').forEach(diagram => {
                diagram.classList.remove('active');
            });
            
            // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ì„ íƒí•œ ë‹¤ì´ì–´ê·¸ë¨ ë³´ì´ê¸°
            const selectedDiagram = document.getElementById(id);
            if (selectedDiagram) {
                selectedDiagram.classList.add('active');
            }
            
            // í´ë¦­í•œ íƒ­ í™œì„±í™”
            event.currentTarget.classList.add('active');
        }
    </script>
</body>
</html>

